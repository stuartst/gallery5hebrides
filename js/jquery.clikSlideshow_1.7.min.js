window.clik||(clik={});
clik.rotator={init:function(a){$.browser.msie&&7>$.browser.version&&"isStyle2"in clik&&clik.isStyle2&&(a.initialTimeout=0,a.timeout=0);var c={element:"",image_sets_id:1,photoArray:[],initialTimeout:5E3,timeout:5E3,opacity:0.8,showPanels:!0,showControls:!0,autoHidePanels:!0,speed:1E3,link:!1,extraTitle:"",extraDetails:"",relatedContentSections:"",updateDocumentTitle:!1,updateHash:!1,keyControl:!1,randomise:!0,randomiseAll:!1,stopOnHover:!0,changeImage:!0,useNavImages:!1,prevPosition:"",nextPosition:"",
adjustPanelWidth:!1,cycle:!0,allowPrevious:!0,allowNext:!0,cropOutsidePadding:!0},b=$.extend({},c,a),e,f=$(b.element),g=f.parent(),n=g.closest(".contentsection"),k=!1,p=function(a,c){if((c=c||a.data&&a.data.previous)?!b.allowPrevious:!b.allowNext)return!1;b.imageId="string"==typeof b.imageSet[0]?""+b.imageId:parseInt(b.imageId,10);var e=getNextId(b.imageId,b.imageSet,c);k=!0;q(a,e);return!1},q=function(k,p,z,G,C){var E="gallery"==b.link?getHomeImageLink(p):b.link,B=arguments,F=f.closest(".contentsection");
z&&(b.imageSet=z);if(F.data("transitioning"))return!1;F.data("transitioning",!0);if(p&&-1!=p){p=""+p;if(!(b.photoArray&&p in b.photoArray||p in(b.photoArray=$.extend({},window.photos||{},window.backgrounds||{}))))return $.ajax({url:"gallery_"+thumbnails[p].galleries_id+".js",dataType:"script",type:"get",complete:$.proxy(function(){b.photoArray=window[a.photoArray||c.photoArray];f.closest(".contentsection-popup_container").length?f.closest(".contentsection-popup_container").trigger("setImage"):q.apply(this,
B)},this)}),F.data("transitioning",!1),!1;f.closest(".contentsection-popup_container").width(function(a,c){return 0<this.offsetLeft&&0<b.photoArray[p].width-f.find("img").width()&&$(this).outerWidth(!0)+b.photoArray[p].width-f.find("img").width()<$(window).width()&&c>f.closest(".contentsection").outerWidth(!0)?c+b.photoArray[p].width-f.find("img").width():""});f=updateImage({nextPhoto:b.photoArray[p],img:f.find("img")[0],$photo:f,$detailContainer:$(b.relatedContentSections),updateDocumentTitle:b.updateDocumentTitle,
updateHash:b.updateHash,updateHashHistory:b.updateHistory,speed:!G&&(b.speed||1),href:E,changeImage:b.changeImage,transitionMode:b.transitionMode,onBefore:function(){var a=$(this),c=function(b,c){var e=$(this),f=e.children(),g=f.outerHeight(!0);return(e=e.height("").height()-g)&&-1!=e?c:a.height()+g-f.height()},e=a.find("a").css("display","inline-block").closest(".contentsection").height(c);this.parentNode&&$(this).siblings(".containerWrap").height(function(a,b){return $(this).children(".contentsection").not(".position-absolute").length||
1<b?b:0});e.data("position")&&"inline"==e.data("position").position&&e.parent().parent().find("div.inlineContainer").each(function(){$(this).replaceWith(function(){return $(this).contents()})});u(p);$("body").trigger("doPhotoViewColumns");b.updateDocumentTitle&&($("body").trigger("pageContentChange",[{type:"photos",id:p}]),clik.commentsInfo={type:"photos",id:p});n.trigger("onBeforeFade");e.length&&(e.css({width:"",margin:""}),$("body").trigger("doPhotoViewColumns"),e.width(e.width()).doManualAlign({inner:a.find("img"),
crop:a.find("a"),padding:n.children(".contentpadding"),cropOutsidePadding:b.cropOutsidePadding}).height(c),e.clikIEContainerWidth(".photo\x3ea"))},onAfter:function(){b.showPanels&&!b.adjustPanelWidth&&g.find(".contentsection").width("").clikAlign(!0,!1);$(b.relatedContentSections).find(".gallery").trigger("clikCarouselUpdate",[p]);n.trigger("clikCarouselUpdate",[p]);F.data("transitioning",!1)},afterFade:function(){b.showPanels&&b.adjustPanelWidth&&$(b.relatedContentSections).not(".contentsection-button").width(f.find("a").width()||
0).filter(".contentsection-container").clikAlign(!0,!1);n.trigger("onAfterFade",[p]);$("body").trigger("doPhotoViewColumns");clik.doColumnResize()}}).parent()}b.imageId=p;E=0;if(!b.cycle){var D=$.inArray(parseInt(b.imageId,10),b.imageSet),H=$(b.relatedContentSections).filter(".contentsection-button").find(".next,.previous").closest(".contentsection").removeClass("inactive");H.not(".hidden").show();b.allowPrevious=b.allowNext=!0;0===D&&(H.filter(":has(.previous)").hide().addClass("inactive"),b.allowPrevious=
!1);D==b.imageSet.length-1&&(H.filter(":has(.next)").hide().addClass("inactive"),E=1,b.allowNext=!1)}E?window.clearTimeout(e):r()},r=function(){window.clearTimeout(e);0<b.timeout&&(e=setTimeout(function(){n.trigger("goNext")},b.timeout))},u=function(a){var c,e;a="string"==typeof b.imageSet[0]?""+a:parseInt(a,10);(c=getNextId(a,b.imageSet))&&c in b.photoArray&&((new Image).src=b.photoArray[c].src);(e=getNextId(a,b.imageSet,!0))&&e in b.photoArray&&((new Image).src=b.photoArray[e].src)};f.length&&("string"==
typeof b.photoArray&&(b.photoArray=window[b.photoArray]),"keyControl"in a||!b.showControls||(b.keyControl=!0),this.getImgIdAndSet(b,f),!b.extraTitle&&b.relatedContentSections&&(b.extraTitle=$(b.relatedContentSections).find(".replaceable_photo-photo_caption")),n.addClass("slideshow"),0<b.initialTimeout&&(e=setTimeout(function(){n.trigger("goNext");g.trigger("mouseleave.clikSlideTimeout")},b.initialTimeout)),this.setupControls(b,p,g),this.setupPanels(b,g,n),this.setupKeyControls(b,n),$.browser.msie&&
7>$.browser.version&&(n.filter(function(){return"absolute"!=$(this).css("position")}).width(n.parent().width()),g.width(n.width()).children(":not(.controls)").width(g.width())),b.updateHash&&(n.unbind("clearHash").bind("clearHash",function(){clik.changeHash("",b.updateHistory)}),$(window).bind("hashchange",function(){var a=b.imageId;n.is(":visible")&&(!k&&clik.checkHash&&(b.imageId=((document.location.hash||document.location.href).match(".*(?:photos_id\x3d|photo_)(.+)(?:.html)?$")||["",""])[1])&&
b.imageId in thumbnails?n.trigger("goTo",[b.imageId,null,!n.is(":visible")||n.closest(".contentsection-popup_container").length&&n.closest("#uberContainer").length]):(b.imageId=a,k=!1))})),n.unbind("goNext").bind("goNext",p).unbind("goPrevious").bind("goPrevious",{previous:!0},p).unbind("goTo").bind("goTo",q),n.is("[id$\x3dpopup_photo]")||n.trigger("goTo",[b.imageId,null,!n.is(":visible")||n.closest(".contentsection-popup_container").length&&n.closest("#uberContainer").length]),"next"==b.link&&n.unbind("click.goNext").bind("click.goNext",
p).css({cursor:"pointer"}),b.stopOnHover&&g.hoverNS(function(){window.clearTimeout(e)},r,"clikSlideTimeout"),"slideshows"in clik||(clik.slideshows={}),clik.slideshows[n.attr("id")]={pause:function(){g.unbind(".clikSlideTimeout");window.clearTimeout(e)},resume:function(){b.stopOnHover&&g.hoverNS(function(){window.clearTimeout(e)},r,"clikSlideTimeout");r()}},n.trigger("photoInit"))},getImgIdAndSet:function(a,c){switch(a.image_sets_id){case "gallery":(a.imageId=(document.location.hash.match(".*photos_id\x3d(.+)$")||
["",""])[1])&&a.imageId in thumbnails||(a.imageId=clik.getPrefixedClass(c.attr("id"),"imagePhoto_"))&&a.imageId in thumbnails||(a.imageId=clik.getPrefixedClass($("body").attr("class"),"content_"))&&a.imageId in thumbnails?a.imageSet=galleries[thumbnails[a.imageId].galleries_id].photoIDs:(a.imageSet=clik.getPrefixedClass($("body").attr("class"),"content_"))&&a.imageSet in galleries?(a.imageSet=galleries[a.imageSet].photoIDs,a.imageId=a.imageSet[0]):(a.imageSet=[],a.imageId="");a.randomiseAll&&a.imageSet.sort(function(){return 0.5-
Math.random()});break;case "galleryindex":a.imageSet=[];$.each(galleries,function(){a.imageSet.push(randomListVal(this.featured_images))});a.imageId=a.imageSet[0];a.randomiseAll&&a.imageSet.sort(function(){return 0.5-Math.random()});break;default:a.imageSet=imageSets[a.image_sets_id]||"",a.imageId=a.randomise?randomListVal(a.imageSet):a.imageSet.split(",")[0],a.imageSet=a.imageSet.split(","),a.randomiseAll&&a.imageSet.sort(function(){return 0.5-Math.random()})}a.imageId=parseInt(a.imageId,10)},showPanels:function(a,
c){window.clearTimeout(a.panelsTimeoutObj);a.panels=$(a.relatedContentSections).filter(".contentsection-container");c.data("hideOverlays",!1).find(a.relatedContentSections).filter(".contentsection-container").filter(function(){return $(this).find(".contentsection:not(.empty)").length}).stop(!0,!0).not(".empty").slideDown(500,function(){$(this).clikAlign()})},hidePanels:function(a,c,b,e){c="undefined"!=typeof c?c:500;window.clearTimeout(b.panelsTimeoutObj);b.panelsTimeoutObj=setTimeout(function(){e.data("hideOverlays",
!0).find(b.relatedContentSections).filter(".contentsection-container").stop(!0,!0).slideUp(c,function(){$(this).hide()})},c)},showControls:function(a){window.clearTimeout(a.controlsTimeoutObj);$(a.relatedContentSections).filter(".contentsection-button").stop(!0,!0).fadeIn(500)},hideControls:function(a,c,b){c="undefined"!=typeof c?c:500;window.clearTimeout(b.controlsTimeoutObj);b.controlsTimeoutObj=setTimeout(function(){$(b.relatedContentSections).filter(".contentsection-button").stop(!0,!0).fadeOut(c);
$(document).unbind(".imageSlideshowControls")},c)},setupControls:function(a,c,b){var e=this;a.showControls?($(a.relatedContentSections).filter(".contentsection-button").find(".next").closest(".contentsection").unbind("click.photoControl").bind("click.photoControl",c).end().end().find(".previous").closest(".contentsection").unbind("click.photoControl").bind("click.photoControl",{previous:!0},c),void 0===a.autoHideControls&&(a.autoHideControls=a.autoHidePanels),a.autoHideControls?b.hoverNS(function(b){e.showControls(a)},
function(b){e.hideControls(b,void 0,a)},"clikSlideControls"):e.showControls(a),b.clikAlign(!0,!1)):e.hideControls({},0,a)},setupPanels:function(a,c,b){var e=this;a.showPanels?(c.find(".contentsection").not(".contentsection-button").alphaBackground(a.opacity).width(c.closest(".contentpadding").width()||c.width()),a.autoHidePanels?(b.data("hideOverlays",!0),c.hoverNS(function(c){e.showPanels(a,b)},function(c){e.hidePanels(c,void 0,a,b)},"clikSlidePanels")):e.showPanels(a,b)):e.hidePanels({},0,a,b)},
setupKeyControls:function(a,c){a.keyControl&&$(document).clikKeyControl({namespace:".imageSlideshowControls"+c.attr("id")+(a.showControls?"":"On"),disableOthers:"keyControlNS"in clik&&clik.keyControlNS.listeningFor in clik.keyControlNS,functions:{left:function(b){if(b.target.form)return!0;b.preventDefault();b.stopPropagation();a.allowPrevious&&c.trigger("goPrevious")},right:function(b){if(b.target.form)return!0;b.preventDefault();b.stopPropagation();a.allowNext&&c.trigger("goNext")}}})},infiniteSlide:function(a){var c=
$.extend({},{element:"",image_sets_id:1,photoArray:[],initialTimeout:5E3,timeout:5E3,opacity:0.8,showPanels:!0,showControls:!0,autoHidePanels:!0,speed:1E3,link:!1,extraTitle:"",extraDetails:"",relatedContentSections:"",updateDocumentTitle:!1,updateHash:!1,updateHistory:!1,keyControls:!1,randomise:!0,randomiseAll:!1,stopOnHover:!0,changeImage:!0,useNavImages:!1,prevPosition:"",nextPosition:"",photoSpacing:10,adjustPanelWidth:!1,touchThreshold:75,touchFallbackToMouseEvents:!1},a),b=$(c.element),e=b.parent(),
f=e.closest(".contentsection"),g=f.children(".contentpadding"),n,k=function(a){return(c.mW-a.outerWidth())/2-a.position().left},p=function(a,b){var e='\x3cdiv id\x3d"imageGridContainer_'+a.id+'" class\x3d"imageGridContainer" style\x3d"display: inline-block; float:left; width: '+(b.w+c.photoSpacing+c.imageBorderWidth)+"px; height: "+(b.h+c.imageBorderHeight)+'px;"\x3e',e=e+('\x3cdiv id\x3d"spacing_l_'+a.id+'" class\x3d"photoSpacing" style\x3d"display: inline-block; float:left; width:'+Math.floor(c.photoSpacing/
2)+"px; height: "+(b.h+c.imageBorderHeight)+'px;"\x3e\x3c/div\x3e'),e=e+('\x3cdiv id\x3d"imagePhoto_'+a.id+'" class\x3d"photo" style\x3d"display: inline-block"\x3e'),e=e+('\x3ca title\x3d"'+a.caption+'" style\x3d"display: inline-block;"\x3e'),e=e+('\x3cimg id\x3d"mainPic_'+a.id+'" class\x3d"mainphoto photo" src\x3d"" def\x3d"'+a.src+'" name\x3d"mainPic_'+a.id+'" style\x3d"width: '+b.w+"px; height: "+b.h+'px;" alt\x3d"'+a.caption+'"\x3e'),e=e+"\x3c/a\x3e\x3c/div\x3e"+('\x3cdiv id\x3d"spacing_r_'+a.id+
'" class\x3d"photoSpacing" style\x3d"display: inline-block; width:'+Math.ceil(c.photoSpacing/2)+"px; height: "+(b.h+c.imageBorderHeight)+'px;"\x3e\x3c/div\x3e');return e+="\x3c/div\x3e"},q=function(){$.each(c.orderedPhotoArray,function(a,b){var e=c.photoArray[b],f=(c.mH-c.imageBorderHeight)/e.height;c.$row.append(p(e,{h:e.height*f,w:e.width*f}))});c.$row.width(c.$row.find(".imageGridContainer").getSum(function(){return $(this).outerWidth(!0)+1}))},r=function(a,b){b=b||a.data&&a.data.previous;c.imageId=
"string"==typeof c.imageSet[0]?""+c.imageId:parseInt(c.imageId,10);var e=getNextId(c.imageId,c.imageSet,b);skipHash=!0;u(a,e,b);return!1},u=function(a,b,e,g){var n=void 0===e,q;c.imageId=b;c.allowPrevious=c.allowNext=!0;var p=c.$row.find("#imageGridContainer_"+b);a=c.$row.find("#imageGridContainer_"+c.$row.data("image_id"));var r,w=1,u=c.$row.data("image_id"),z=a.length?parseFloat(c.$row.css("left"))-k(a):0;q=$.inArray(b,c.imageSet);u="string"==typeof c.imageSet[0]?""+u:parseInt(u,10);posOld=$.inArray(u,
c.imageSet);n&&(e=posOld>q);g||(w=e?posOld<q?posOld+c.imageSet.length-q:posOld-q:posOld>q?q+c.imageSet.length-posOld:q-posOld);for(u=0;u<w;u++)if(q=!0,e)for(;q||0<k(p)&&p.index()<c.imageSet.length/2;)q=!1,r=c.$row.find(".imageGridContainer").last().prependTo(c.$row).find("img"),""!=r.attr("def")&&r.attr("src",r.attr("def")).attr("def",""),c.$row.css("left",k(a)+z);else q=c.$row.find('img[def!\x3d""]').eq(0),q.length&&q.attr("src",q.attr("def")).attr("def","");updateImage({nextPhoto:c.photoArray[b],
$photo:c.$row,$detailContainer:$(c.relatedContentSections),updateDocumentTitle:c.updateDocumentTitle,updateHash:c.updateHash,updateHashHistory:c.updateHistory,speed:0,css:!1,changeImage:!1});c.$row.stop(!0,!0).animate({left:k(p)},c.speed,function(){var a;if(n||!e&&!g){for(var q=0;q<w;q++)for(a=c.$row.find(".imageGridContainer:first");a.width()<Math.abs(c.$row.position().left)&&1<p.index();)a.appendTo(c.$row),c.$row.css("left",k(p)),a=c.$row.find(".imageGridContainer:first");A()}f.trigger("clikCarouselUpdate",
[c.imageId]).trigger("onAfterFade",[c.imageId]);$(c.relatedContentSections).find(".gallery").trigger("clikCarouselUpdate",[c.imageId]);c.updateDocumentTitle&&($("body").trigger("pageContentChange",[{type:"photos",id:b}]),clik.commentsInfo={type:"photos",id:b})})},w=function(a,b){var c=[];b=0>$.inArray(b,a)?$.inArray(""+b,a):$.inArray(b,a);if(-1<b){for(i=b;i<a.length;i++)c.push(a[i]);for(i=0;i<b;i++)c.push(a[i])}return c},A=function(){window.clearTimeout(n);0<c.timeout&&(n=setTimeout(function(){f.trigger("goNext")},
c.timeout))},z=function(){var a={},b=function(b){var e=getNextId(a.next,c.orderedPhotoArray,"left"==b),f=c.$row.find("#mainPic_"+e);""!=f.attr("def")&&f.attr("src",f.attr("def")).attr("def","");"left"==b&&f.closest("div.imageGridContainer").prependTo(c.$row);f="left"==b?a.$current.prevAll("div.imageGridContainer").andSelf():a.$current.nextAll("div.imageGridContainer").andSelf().filter(function(){return $(this).find('img[def\x3d""]').length});a.next=e;f=f.last();return 0==f.length?!1:!("left"==b?$.inArray(e,
c.orderedPhotoArray)<=c.orderedPhotoArray.length/2:$.inArray(e,c.orderedPhotoArray)==c.orderedPhotoArray.length-1)&&0>f.position().left-("left"==b?c.mW/2-f.outerWidth(!0)/2:c.mW-f.innerWidth()+a.$first.outerWidth(!0))};a.current="number"===typeof c.orderedPhotoArray[0]?parseInt(c.imageId,10):c.imageId+"";a.next=a.current;a.$current=c.$row.find("#mainPic_"+c.imageId);a.$current=a.$current.attr("src",a.$current.attr("def")).attr("def","").closest(".imageGridContainer");a.addMoreLeft=!0;for(a.addMoreRight=
!0;a.addMoreLeft;)a.addMoreLeft=b("left");a.next=a.current;for(a.$first=c.$row.find("div.imageGridContainer").first();a.addMoreRight;)a.addMoreRight=b("right")};b.length&&(c.$row=$('\x3cdiv class\x3d"rotatorSlide" style\x3d"position:relative;"/\x3e'),b.replaceWith($('\x3cdiv class\x3d"overflowHidden" style\x3d"position:relative; width:'+c.mW+"; height:"+c.mH+'; overflow:hidden;"/\x3e').append(c.$row)),"string"==typeof c.photoArray&&(c.photoArray=window[c.photoArray]),"keyControl"in a||!c.showControls||
(c.keyControl=!0),this.getImgIdAndSet(c,b),c.orderedPhotoArray=w(c.imageSet,c.imageId),c.mW=f.width()-(g.outerWidth()-g.width()),c.mH=f.height()-(g.outerHeight()-g.height()),c.mH&&(q(),z(),this.setupControls(c,r,f),this.setupPanels(c,f,f),this.setupKeyControls(c,f),u({},c.imageId,!1,!0),c.useTouch&&f.swipe("destroy").swipe({excludedElements:"label, button, input, select, textarea,.noSwipe",threshold:c.touchThreshold,cancelThreshold:c.touchThreshold,fallbackToMouseEvents:c.touchFallbackToMouseEvents,
allowPageScroll:"vertical",swipeStatus:function(a,b,e,g,n,q,p){if(1>=q)switch(b){case "start":a=c.$row.find("#imageGridContainer_"+c.$row.data("image_id"));c.slide={$currentImg:a,max:a.width(),distance:0,id:c.$row.data("image_id")};clik.slideshows[f.attr("id")].pause();break;case "move":if(g<c.slide.max)switch(e){case "left":c.$row.css("left",(parseFloat(c.$row.css("left"))||0)-g+c.slide.distance);c.slide.distance=g;break;case "right":c.$row.css("left",(parseFloat(c.$row.css("left"))||0)+g-c.slide.distance),
c.slide.distance=g}break;case "end":switch(e){case "left":case "right":if(g<$(this).swipe("option","threshold"))c.$row.stop(!0,!0).animate({left:k(c.slide.$currentImg)},c.speed),clik.slideshows[f.attr("id")].resume();else switch(e){case "left":f.trigger("goNext");break;case "right":f.trigger("goPrevious")}return!1;default:clik.slideshows[f.attr("id")].resume()}c.slide={};break;case "cancel":c.$row.stop(!0,!0).animate({left:k(c.slide.$currentImg)},c.speed),clik.slideshows[f.attr("id")].resume(),c.slide=
{}}}}),f.unbind("goNext,goPrevious,goTo").bind("goNext",r).bind("goPrevious",{previous:!0},r).bind("goTo",u),0<c.initialTimeout&&(n=setTimeout(function(){f.trigger("goNext");f.trigger("mouseleave.clikSlideTimeout")},c.initialTimeout)),c.stopOnHover&&e.hoverNS(function(){window.clearTimeout(n)},A,"clikSlideTimeout"),"slideshows"in clik||(clik.slideshows={}),clik.slideshows[f.attr("id")]={pause:function(){e.unbind(".clikSlideTimeout");window.clearTimeout(n)},resume:function(){c.stopOnHover&&e.hoverNS(function(){window.clearTimeout(n)},
A,"clikSlideTimeout");A()}}))}};
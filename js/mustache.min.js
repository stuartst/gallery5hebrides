var Mustache=function(){var a={},c=function(){};c.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":!0},context:{},render:function(a,c,f,g){g||(this.context=c,this.buffer=[]);if(this.includes("",a)){a=this.render_pragmas(a);var n=this.render_section(a,c,f);!1===n&&(n=this.render_tags(a,c,f,g));if(g)return n;this.sendLines(n)}else{if(g)return a;this.send(a)}},send:function(a){""!==a&&this.buffer.push(a)},sendLines:function(a){if(a){a=a.split("\n");for(var c=
0;c<a.length;c++)this.send(a[c])}},render_pragmas:function(a){if(!this.includes("%",a))return a;var c=this,f=this.getCachedRegex("render_pragmas",function(a,b){return RegExp(a+"%([\\w-]+) ?([\\w]+\x3d[\\w]+)?"+b,"g")});return a.replace(f,function(a,b,f){if(!c.pragmas_implemented[b])throw{message:"This implementation of mustache doesn't understand the '"+b+"' pragma"};c.pragmas[b]={};f&&(a=f.split("\x3d"),c.pragmas[b][a[0]]=a[1]);return""})},render_partial:function(a,c,f){a=this.trim(a);if(!f||void 0===
f[a])throw{message:"unknown_partial '"+a+"'"};return"object"!=typeof c[a]?this.render(f[a],c,f,!0):this.render(f[a],c[a],f,!0)},render_section:function(a,c,f){if(!this.includes("#",a)&&!this.includes("^",a))return!1;var g=this,n=this.getCachedRegex("render_section",function(a,b){return RegExp("^([\\s\\S]*?)"+a+"(\\^|\\#)\\s*(.+)\\s*"+b+"\n*([\\s\\S]*?)"+a+"\\/\\s*\\3\\s*"+b+"\\s*([\\s\\S]*)$","g")});return a.replace(n,function(a,b,n,r,u,w){a=b?g.render_tags(b,c,f,!0):"";w=w?g.render(w,c,f,!0):"";
var A;r=g.find(r,c);"^"===n?A=!r||g.is_array(r)&&0===r.length?g.render(u,c,f,!0):"":"#"===n&&(A=g.is_array(r)?g.map(r,function(a){return g.render(u,g.create_context(a),f,!0)}).join(""):g.is_object(r)?g.render(u,g.create_context(r),f,!0):"function"===typeof r?r.call(c,u,function(a){return g.render(a,c,f,!0)}):r?g.render(u,c,f,!0):"");return a+A+w})},render_tags:function(a,c,f,g){var n=this,k=function(){return n.getCachedRegex("render_tags",function(a,b){return RegExp(a+"(\x3d|!|\x3e|\\{|%)?([^\\/#\\^]+?)\\1?"+
b+"+","g")})},p=k(),q=function(a,b,g){switch(b){case "!":return"";case "\x3d":return n.set_delimiters(g),p=k(),"";case "\x3e":return n.render_partial(g,c,f);case "{":return n.find(g,c);default:return n.escape(n.find(g,c))}};a=a.split("\n");for(var r=0;r<a.length;r++)a[r]=a[r].replace(p,q,this),g||this.send(a[r]);if(g)return a.join("\n")},set_delimiters:function(a){a=a.split(" ");this.otag=this.escape_regex(a[0]);this.ctag=this.escape_regex(a[1])},escape_regex:function(a){arguments.callee.sRE||(arguments.callee.sRE=
RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","g"));return a.replace(arguments.callee.sRE,"\\$1")},find:function(a,c){function f(a){return!1===a||0===a||a}a=this.trim(a);var g;a.match(/([a-z_]+)\./ig)?g=f(this.walk_context(a,c)):f(c[a])?g=c[a]:f(this.context[a])&&(g=this.context[a]);return"function"===typeof g?g.apply(c):void 0!==g?g:""},walk_context:function(a,c){for(var f=a.split("."),g=void 0!=c[f[0]]?c:this.context,n=g[f.shift()];void 0!=n&&0<f.length;)g=n,n=n[f.shift()];return"function"===
typeof n?n.apply(g):n},includes:function(a,c){return-1!=c.indexOf(this.otag+a)},escape:function(a){a=String(null===a?"":a);return a.replace(/&(?!\w+;)|["'<>\\]/g,function(a){switch(a){case "\x26":return"\x26amp;";case '"':return"\x26quot;";case "'":return"\x26#39;";case "\x3c":return"\x26lt;";case "\x3e":return"\x26gt;";default:return a}})},create_context:function(a){if(this.is_object(a))return a;var c=".";this.pragmas["IMPLICIT-ITERATOR"]&&(c=this.pragmas["IMPLICIT-ITERATOR"].iterator);var f={};
f[c]=a;return f},is_object:function(a){return a&&"object"==typeof a},is_array:function(a){return"[object Array]"===Object.prototype.toString.call(a)},trim:function(a){return a.replace(/^\s*|\s*$/g,"")},map:function(a,c){if("function"==typeof a.map)return a.map(c);for(var f=[],g=a.length,n=0;n<g;n++)f.push(c(a[n]));return f},getCachedRegex:function(b,c){var f=a[this.otag];f||(f=a[this.otag]={});var g=f[this.ctag];g||(g=f[this.ctag]={});(f=g[b])||(f=g[b]=c(this.otag,this.ctag));return f}};return{name:"mustache.js",
version:"0.4.0-dev",to_html:function(a,e,f,g){var n=new c;g&&(n.send=g);n.render(a,e||{},f);if(!g)return n.buffer.join("\n")}}}();
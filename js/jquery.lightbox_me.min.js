(function(a){a.fn.lightbox_me=function(c){return this.each(function(){function b(){var b=k[0].style;k.trigger("beforeClose");k.fadeOut(g.lightboxSpeed,function(){g.showOverlay?n.fadeOut(g.overlaySpeed,function(){n.remove();g.parentLightbox&&g.parentLightbox.fadeIn(200);k.trigger("onClose")}):k.trigger("onClose");k.removeClass(g.openClass);g.destroyOnClose?k.remove():k.hide()});p.remove();k.undelegate(g.closeSelector,"click");a(window).unbind("reposition",e);a(window).unbind("reposition",f);a(window).unbind("scroll",
f);a(window).unbind("keyup.lightbox_me");q&&b.removeExpression("top")}function e(){a(window).height()<a(document).height()?(n.css({height:a(document).height()+"px"}),p.css({height:a(document).height()+"px"})):(n.css({height:"100%"}),q&&(a("html,body").css("height","100%"),p.css("height","100%")))}function f(b,c){var e=k.css(g.modalCSS)[0].style,f=a(document).scrollTop(),p=Math.max(parseInt(k.css("marginTop"),10)||0,0),r=k[0].offsetTop-p,E=a(window).height(),B=k.outerHeight(!0),p=k[0].offsetTop+B-
p;k.css({zIndex:g.zIndex+3,left:"",position:"absolute"});n.css({position:"fixed"});B>=E?(k.addClass("valignOld-"+clik.getPrefixedClass(k.attr("class"),"valign-")).addClass("valign-top"),f<r||!e.position.match(/absolute|fixed/)||c?k.css({top:f+"px",marginTop:""}):f+E>=p&&k.css({top:f+E-B+"px",marginTop:""})):(k.removeClass("valign-top").addClass("valign-"+clik.getPrefixedClass(k.attr("class"),"valignOld-")),q?(e.position="absolute",f=g.modalCSS&&g.modalCSS.top?parseInt(g.modalCSS.top,10):0,e.setExpression("top",
"((blah \x3d document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+f+') + "px"')):k.css({position:"fixed",top:""}))}var g=a.extend({},a.fn.lightbox_me.defaults,c),n=a(),k=a(this),p=a('\x3ciframe id\x3d"foo" style\x3d"z-index: '+(g.zIndex+1)+';border: none; margin: 0; padding: 0; position: absolute; width: 100%; height: 100%; top: 0; left: 0; filter: mask();"/\x3e'),q=a.browser.msie&&7>a.browser.version;if(k.hasClass(g.openClass))return k.trigger("reposition"),
!1;k.addClass(g.openClass);g.showOverlay&&(n=0<a(".js_lb_overlay:visible").length?a('\x3cdiv class\x3d"lb_overlay_clear js_lb_overlay"/\x3e'):a('\x3cdiv class\x3d"'+g.classPrefix+'_overlay js_lb_overlay"/\x3e'),k.data("$overlay",n));if(q){var r=/^https/i.test(window.location.href||"")?"javascript:false":"about:blank";p.attr("src",r);a("body").append(p)}a("body").append(k.hide()).append(n);g.showOverlay&&(e(),n.css({position:"absolute",width:"100%",top:0,left:0,right:0,bottom:0,zIndex:g.zIndex+2,display:"none"}),
n.hasClass("lb_overlay_clear")||n.css(g.overlayCSS));g.showOverlay?n.fadeIn(g.overlaySpeed,function(){f(null,!0);k[g.appearEffect](g.lightboxSpeed,function(){e();f(null,!0);g.onLoad()})}):(f(null,!0),k[g.appearEffect](g.lightboxSpeed,function(){g.onLoad()}));g.parentLightbox&&g.parentLightbox.fadeOut(200);a(window).resize(e).resize(f).scroll(f);a(window).bind("keyup.lightbox_me",function(a){(27==a.keyCode||27==a.DOM_VK_ESCAPE&&0==a.which)&&g.closeEsc&&b()});g.closeClick&&n.click(function(a){b();a.preventDefault()});
k.delegate(g.closeSelector,"click",function(a){b();a.preventDefault()});k.bind("close",b);k.bind("reposition",f);k.bind("onClose",g.onClose)})};a.fn.lightbox_me.defaults={appearEffect:"fadeIn",appearEase:"",overlaySpeed:250,lightboxSpeed:300,closeSelector:".close",closeClick:!0,closeEsc:!0,destroyOnClose:!1,showOverlay:!0,parentLightbox:!1,onLoad:function(){},onClose:function(){},classPrefix:"lb",zIndex:999,centered:!1,modalCSS:{top:"40px"},overlayCSS:{background:"black",opacity:0.3},openClass:"lightbox_open"}})(jQuery);